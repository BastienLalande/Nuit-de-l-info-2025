<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>XSS Persistante</title>
</head>

<body style="background:#111; color:white; font-family:monospace">

    <h1>üí• XSS PERSISTANTEb,i</h1>

    <p>√âcris un commentaire (il sera enregistr√© et r√©affich√© √† chaque chargement).</p>

    <input id="msg" type="text" placeholder="√âcris ici...">
    <button onclick="ajouter()">Envoyer</button>

    <h2>üìù Commentaires :</h2>

    <div id="liste" style="padding:10px; background:#222; border:1px solid #444;"></div>

    <script>
        // üß† Les commentaires sont stock√©s dans localStorage (persistance)
        let commentaires = JSON.parse(localStorage.getItem("comments")) || [];

        function afficherCommentaires() {
            let html = "";
            commentaires.forEach(c => {
                // ‚ùå FAILLE : insertion directe = XSS persistante
                html += "<p>" + c + "</p>";
            });
            document.getElementById("liste").innerHTML = html;
        }

        function ajouter() {
            let texte = document.getElementById("msg").value;

            // On stocke le message tel quel (faille volontaire)
            commentaires.push(texte);

            localStorage.setItem("comments", JSON.stringify(commentaires));
            afficherCommentaires();
        }

        // ‚õî La XSS s'ex√©cute automatiquement √† CHAQUE rechargement
        afficherCommentaires();
    </script>

</body>
</html>
